<!DOCTYPE html><meta charset="UTF-8"><html lang="en"><head><title>Proof of Liability</title><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.1/font/bootstrap-icons.css"><link rel="stylesheet" href="./style.f6d070a2.css"><style>.node text{font:14px robot;fill:#fff;font-weight:700}.node text tspan{font-weight:400}.link{fill:none;stroke:#ccc;stroke-width:2px}</style><meta name="viewport" content="width=device-width, initial-scale=1"></head><body> <div class="container"> <div class="row"> <div class="col"></div> <div class="col-11"> <div class="row"></div> <h1 class="display-3">Proof of Liability <small class="text-muted">- Distributed Auditing</small></h1> </div> <div class="row"> <div class="nav nav-fill nav-tabs" id="nav-tab" role="tablist"> <button class="active nav-link" id="nav-desc-tab" data-bs-toggle="tab" data-bs-target="#nav-desc" type="button" role="tab" aria-controls="nav-desc" aria-selected="true">Description</button> <button class="nav-link" id="nav-data-tab" data-bs-toggle="tab" data-bs-target="#nav-data" type="button" role="tab" aria-controls="nav-data" aria-selected="true">Load Data</button> <button class="nav-link" id="nav-tree-tab" data-bs-toggle="tab" data-bs-target="#nav-tree" type="button" role="tab" aria-controls="nav-tree" aria-selected="false">Build Tree</button> <button class="nav-link" id="nav-verify-tab" data-bs-toggle="tab" data-bs-target="#nav-verify" type="button" role="tab" aria-controls="nav-verify" aria-selected="false">Verify Audit</button> </div> </div> <div class="row"> <div class="card"> <div class="card-body"> <div class="tab-content" id="nav-tabContent"> <div class="active fade show tab-pane" id="nav-desc" role="tabpanel" aria-labelledby="nav-desc-tab"> <div class="row"> <h1 class="display-6 offset-md-1">Introduction</h1> </div> <div class="row"> <div class="col-md-9 offset-md-1"> <p>Proof of Liabilities (PoL) is a scheme designed to let companies that accept monetary deposits from consumers (e.g. Bitcoin exchanges, gambling websites, online Bitcoin wallets, etc.) prove their total amount of deposits (their liabilities) without compromising the privacy of individual users. </p> </div> </div> <div class="row"> <h1 class="display-6 offset-md-1">How does it work?</h1> </div> <div class="row"> <div class="col-md-9 offset-md-1"> <ol> <li class="mt-2"><strong>Build users data set</strong> - for each user we'll compute his commitment as follow \(sha256(Id_{user} | balance_{user}) = commitment_{user}\).</li> <li class="mt-2"><strong>Build a liability tree</strong> - based on the users' data set we'll build a summation merkle tree.</li> <li class="mt-2"><strong>The total liability</strong> - will be at the root of the tree. All leafs will be sums up to the root. </li> <li class="mt-2"><strong>Each user can verify</strong> that his liability were taken into account by verify the path from his commitment at the leaf to the published root by Celsius.</li> </ol> </div> </div> </div> <div class="fade tab-pane" id="nav-data" role="tabpanel" aria-labelledby="nav-data-tab"> <div class="row"> <h1 class="display-6 offset-md-1">Users table <small class="text-muted">(internal DB)</small> </h1> </div> <div class="row"> <div id="maintable-table" class="table-editable"> <table id="users_table" class="table table-bordered table-responsive-md table-sm table-striped text-center text-nowrap"> <thead> <tr> <th class="text-center">User Id</th> <th class="text-center">Balance</th> <th class="text-center">Commitment</th> </tr> </thead> <tbody> <tr> <td class="pt-3-half user-id" contenteditable="true">alice@celsius.network</td> <td class="pt-3-half user-amount" contenteditable="true">30</td> <td class="pt-3-half user-commitment">f604ac9dd5566a447c0cddc8cd655e08080b3248d39243eddfc864f49b0bb280</td> <td> <span class="table-remove"><button type="button" class="btn btn-danger btn-rounded btn-sm my-0"> Remove </button></span> </td> </tr>  <tr> <td class="pt-3-half user-id" contenteditable="true">bob@celsius.network</td> <td class="pt-3-half user-amount" contenteditable="true">45</td> <td class="pt-3-half user-commitment">ba4a44eb2d003799fa07a824f2004f195a4f6ea01dc2b20d130787c2a41ac926</td><td> <span class="table-remove"><button type="button" class="btn btn-danger btn-rounded btn-sm my-0"> Remove </button></span> </td> </tr>  <tr> <td class="pt-3-half user-id" contenteditable="true">ron@celsius.network</td> <td class="pt-3-half user-amount" contenteditable="true">3</td> <td class="pt-3-half user-commitment">a9264a3e5070c50b06c674f84a691c8ca1b1ae0be77bcc06c79551912a1c09da</td> <td> <span class="table-remove"><button type="button" class="btn btn-danger btn-rounded btn-sm my-0"> Remove </button></span> </td> </tr>  </tbody> </table> <div class="row"> <div class="col-11"></div> <div class="col-1"><button type="button" class="bottom-0 btn btn-primary end-0" id="btn-add-user">Add</button></div> </div> </div> </div> <div class="row"> <div id="users-table"></div> </div> </div> <div class="fade tab-pane" id="nav-tree" role="tabpanel" aria-labelledby="nav-tree-tab"> <graph id="merkle-graph"></graph> </div> <div class="fade tab-pane" id="nav-verify" role="tabpanel" aria-labelledby="nav-verify-tab"> <div class="justify-content-center row"> <h1 class="display-5 text-center">How to verify the audit?</h1> </div> <div class="row"> <h4 class="display-6 offset-md-1"><u>Prover side</u></h4> </div> <div class="offset-md-1 row"> <h5 class="display-7">Publish 3 things <i class="bi bi-broadcast-pin"></i></h5> </div> <div class="offset-sm-1 row" style="padding-left:30px;"> <ul> <li>The merkle tree root (commitment + total liability)</li> <li>A ZKP proof for the correctness of the tree</li> <li>Send each user its own authentication path</li> </ul> </div> <div class="offset-md-1 row"> <p>In our case the root node value is <kbd id="published-root-text">0eacb4896fa4a123c71dc111b96ff6d00ad654e5943075a250ec11ec50d40aac</kbd><br> And the proof is <kbd>&#960</kbd></p> </div> <div class="row"> <div class="col-md-5 offset-md-1"> <h4 class="display-6"><u>Verifer side</u></h4> </div> <div class="align-items-center col-md-2 d-flex offset-md-1"> <select id="user-verify-select" class="form-select" onchange="if (this.selectedIndex) {let cmmt = computeCommitmentAndPopulate(this.value); updateGraphB(cmmt);}">  </select> </div> </div> <div class="offset-md-1 row"> <h5 class="display-7">Compute its own commitment <i class="bi bi-pen"></i></h5> </div>    <div class="mt-3 offset-md-1 row" id="verify-commitment-compution"> </div> <div class="mt-5 offset-md-1 row"> <h5 class="display-7">Verifer checks if he have a path to the root node <i class="bi bi-search"></i></h5> </div> <div class="offset-md-1 row"> <p>The prover provides each user an authentication path from his commitment to the liability tree's root, which is the proof for including the verifier's liability within the total sum.</p> </div> <div class="offset-md-1 row"> <graph-b id="merkle-graph-verifer"></graph-b> </div> </div> </div> </div> </div> </div> </div> <div class="col"></div> </div>  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin></script> <script src="https://d3js.org/d3.v4.min.js"></script> <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/js-sha256/0.9.0/sha256.min.js" integrity="sha512-szJ5FSo9hEmXXe7b5AUVtn/WnL8a5VofnFeYC2i2z03uS2LhAch7ewNLbl5flsEmTTimMN0enBZg/3sQ+YOSzQ==" crossorigin referrerpolicy="no-referrer"></script> <script src="./main.79c297a1.js"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script> <script>function t(t){var n=t.data.commitment,e=t.parent.data,r=e.children[0],a=e.children[1];return n===r.commitment?a:r}function n(){var t=document.getElementById("published-root-text");e(d3.select('graph-b .node[node-name="'+t.innerText+'"]').datum())}function e(t){console.log("recurisve iteration. Value:"+t.data.commitment),t.children||r(t.data.commitment),t.children&&(e(t.children[0]),e(t.children[1]))}function r(t){d3.select('graph-b .node[node-name="'+t+'"]').node().dispatchEvent(new Event("click"))}function a(t){var n=$("#users_table > tbody > tr"),e=!1,r="";for(amount=0,i=0;i<n.length;i++){var a=$(n[i]);a.find("td:eq(0)").text()==t&&(e=!0,amount=a.find("td:eq(1)").text(),r=a.find("td:eq(2)").text())}return 1!=e?(alert("error - cant find user name on the users table"),""):($("#verify-commitment-compution").html(""),$("#verify-commitment-compution").append('<p id ="commitment-eq">\\(commitment_{user} = sha256(Id_{user} | balance_{user}) = sha256('+t+" | "+amount+")\\)"),$("#verify-commitment-compution").append('<p id ="commitment-eq-2">\\(commitment_{user} = '+r+"\\)"),MathJax.typeset(["#commitment-eq","#commitment-eq-2"]),r)}function o(e){console.log("expand graph before customize"),n(),console.log("input to update-graph-b: "+e);var a=d3.select('.node[node-name="'+e+'"]').datum();for(console.log("currNode: "+a.data.commitment),console.log("currNode.parnet: "+a.parent.data.commitment);a.parent;)console.log("getNodeParnetOtherChild. value: "+t(a).commitment),console.log("trying to collapse with commitment: "+t(a).commitment),r(t(a).commitment),a=a.parent}var c=["#0E1766","#710BC2","#F63AAC","#d281d2","#7aa0cb","#d281d2","#000000","#F6EBFF"];function m(t){for(var n=1;n<t.length;n*=2);for(var e=[],r=0;r<n;r++)r<t.length?e.push({commitment:t[r].commitment,amount:t[r].amount}):e.push({commitment:sha256(""),amount:0});var a=[];a.push(e);for(var o=e;o.length>1;){for(var i=[],c=1;c<o.length;c+=2){var m=o[c-1].amount+o[c].amount,u={commitment:sha256(m+o[c-1].commitment+o[c].commitment),amount:m};i.push(u)}a.push(i),o=i}for(var l=[],d=a.length;d>=0;d--)l.push.apply(l,a[d]);return l}function u(t){var n={name:t[0].amount.toString(),fill:c[0],subname:s(t[0].commitment),commitment:t[0].commitment,children:[]},e=l(2,1,t);e&&n.children.push(e);var r=l(3,1,t);return r&&n.children.push(r),n}function l(t,n,e){if(t>e.length)return"";var r={name:e[t-1].amount.toString(),fill:c[n],subname:s(e[t-1].commitment),commitment:e[t-1].commitment,children:[]},a=l(2*t,n+1,e);a&&r.children.push(a);var o=l(2*t+1,n+1,e);return o&&r.children.push(o),r}function d(t,n,e,r){document.getElementById(n).innerHTML="";var a,o=20,i=90,c=30,m=90,u=960-m-i,l=d3.select(e).append("svg").attr("width",u+i+m).attr("height",700+o+c).append("g").attr("transform","translate("+m+","+o+")"),d=0,s=750,h=d3.tree().size([700,u]);(a=d3.hierarchy(t,function(t){return t.children})).x0=350,a.y0=0,1==r&&a.children.forEach(function t(n){n.children&&(n._children=n.children,n._children.forEach(t),n.children=null)}),function t(n){var e=h(a);var r=e.descendants(),o=e.descendants().slice(1);r.forEach(function(t){t.y=180*t.depth});var i=l.selectAll("g.node").data(r,function(t){return t.id||(t.id=++d)});var c=i.enter().append("g").attr("class","node").attr("transform",function(t){return"translate("+n.x0+","+n.y0+")"}).on("click",y);var m=60;c.append("rect").on("click",y).attr("class","node").attr("width",m).attr("height",60).attr("x",0).attr("stroke","grey").attr("stroke-width","2px").attr("y",-30).attr("rx","1").attr("node-name",function(t){return t.data.commitment.trim()}).style("fill",function(t){return t.data.fill});c.append("text").attr("dy","-.35em").attr("x",function(t){return 20}).attr("text-anchor",function(t){return"start"}).text(function(t){return t.data.name}).append("tspan").attr("dy","1.75em").attr("x",function(t){return 13}).text(function(t){return t.data.subname}).attr("x",function(t){return 4});var u=c.merge(i);u.transition().duration(s).attr("transform",function(t){return"translate("+t.x+","+t.y+")"});u.select("circle.node").attr("r",10).style("fill",function(t){return t._children?"lightsteelblue":"#fff"}).attr("cursor","pointer");var f=i.exit().transition().duration(s).attr("transform",function(t){return"translate("+n.x+","+n.y+")"}).remove();f.select("circle").attr("r",1e-6);f.select("text").style("fill-opacity",1e-6);var p=l.selectAll("path.link").data(o,function(t){return t.id});var v=p.enter().insert("path","g").attr("class","link").attr("d",function(t){var e={x:n.x0,y:n.y0};return x(e,e)});var g=v.merge(p);g.transition().duration(s).attr("d",function(t){return x(t,t.parent)});p.exit().transition().duration(s).attr("d",function(t){var e={x:n.x,y:n.y};return x(e,e)}).remove();r.forEach(function(t){t.x0=t.x,t.y0=t.y});function x(t,n){return path="M ".concat(t.x+m/2," ").concat(t.y,"\n              C ").concat((t.x+n.x)/2+m/2," ").concat(t.y,",\n                ").concat((t.x+n.x)/2+m/2," ").concat(n.y,",\n                ").concat(n.x+m/2," ").concat(n.y),path}function y(n){n.children?(n._children=n.children,n.children=null):(n.children=n._children,n._children=null),t(n)}}(a)}function s(t){var n=t.trim();return n.substring(0,3)+"..."+n.substring(n.length-3)}</script> </body></html>
